{* /frontend/cron-message *}
{* version 1.0 *}

<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui">
    <title>Cron Message Management - CronPost</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body class="theme-dark main-application-page">
    <main id="main-content" class="container mt-4">
        {* Include dashboard header *}
        <div class="page-header mb-4">
            <h2>Initial Message (IM) & Schedule</h2>
            <p>This is the first message that will be sent if you miss your check-ins. Its schedule determines your check-in loop.</p>
        </div>

        {* General status message *}
        <div id="formStatusMessage" class="alert" style="display: none;"></div>
        
        <form id="imForm">
            <ul class="nav nav-tabs" id="imTab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="content-tab" data-bs-toggle="tab" data-bs-target="#content-tab-pane" type="button" role="tab" aria-controls="content-tab-pane" aria-selected="true">1. Message Content</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="schedule-tab" data-bs-toggle="tab" data-bs-target="#schedule-tab-pane" type="button" role="tab" aria-controls="schedule-tab-pane" aria-selected="false">2. Schedule</button>
                </li>
            </ul>

            <div class="tab-content card" id="imTabContent">
                {* TAB 1: MESSAGE CONTENT *}
                <div class="tab-pane fade show active card-body" id="content-tab-pane" role="tabpanel" aria-labelledby="content-tab" tabindex="0">
                    <div class="mb-3">
                        <label for="messageTitle" class="form-label">Message Title (Optional)</label>
                        <input type="text" class="form-control" id="messageTitle" placeholder="e.g., A note for my family">
                    </div>
                    <div class="mb-3">
                        <label for="messageContent" class="form-label">Message Body</label>
                        <textarea class="form-control" id="messageContent" rows="10" required placeholder="Write your message here..."></textarea>
                        <div class="form-text">Simple HTML is supported.</div>
                    </div>
                    <hr>
                    {* Receivers Section *}
                    <div class="mb-3">
                        <label class="form-label">Receivers</label>
                        <div id="receiverList" class="mb-2">
                            {* Receiver emails will be added here by JS *}
                        </div>
                        <div class="input-group">
                            <input type="email" class="form-control" id="receiverEmailInput" placeholder="recipient@example.com">
                            <button class="btn btn-outline-secondary" type="button" id="addReceiverBtn">Add</button>
                        </div>
                         <div id="receiverError" class="form-text text-danger"></div>
                    </div>
                    <hr>
                    {* Attachments Section - For Premium users *}
                    <div id="attachmentSection" class="mb-3" style="display: none;">
                        <label class="form-label">Attachments (Premium Only)</label>
                        <div id="attachmentList">
                             {* Attached file info will be shown here *}
                        </div>
                        <button class="btn btn-outline-info" type="button" id="manageAttachmentsBtn">Manage Attachments</button>
                    </div>
                </div>

                {* TAB 2: SCHEDULE *}
                <div class="tab-pane fade card-body" id="schedule-tab-pane" role="tabpanel" aria-labelledby="schedule-tab" tabindex="0">
                    <h5>Check-in Loop Type</h5>
                    <div class="form-check">
                      <input class="form-check-input" type="radio" name="scheduleType" id="loopCheckin" value="loop" checked>
                      <label class="form-check-label" for="loopCheckin">
                        Looping Check-in (Recommended)
                      </label>
                    </div>
                    <div class="form-check mb-3">
                      <input class="form-check-input" type="radio" name="scheduleType" id="unloopCheckin" value="unloop">
                      <label class="form-check-label" for="unloopCheckin">
                        One-time Specific Date
                      </label>
                    </div>
                    
                    {* Looping Options Container *}
                    <div id="loopOptionsContainer">
                        <div class="mb-3">
                            <label for="clcType" class="form-label">Loop Frequency</label>
                            <select class="form-select" id="clcType">
                                <option value="every_day">Every Day</option>
                                <option value="specific_days">Specific Day Interval</option>
                                <option value="day_of_week">A Specific Day of the Week</option>
                                <option value="date_of_month">A Specific Date of the Month</option>
                                <option value="date_of_year">A Specific Date of the Year</option>
                            </select>
                        </div>
                        <div id="clc-value-inputs" class="mb-3">
                            {* Dynamic inputs based on clcType selection will appear here *}
                        </div>
                    </div>

                    {* Unlooping Options Container *}
                    <div id="unloopOptionsContainer" style="display: none;">
                        <div class="mb-3">
                            <label for="clcSpecificDate" class="form-label">Select Send Date</label>
                            <input type="date" class="form-control" id="clcSpecificDate">
                        </div>
                    </div>

                    <hr>
                    <h5>Prompt & Check-in Window</h5>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="clcPromptTime" class="form-label">Check-in Prompt Time</label>
                            <input type="time" class="form-control" id="clcPromptTime" required>
                            <div class="form-text">Time of day (in your timezone) you'll be prompted to check-in.</div>
                        </div>
                        <div class="col-md-6 mb-3">
                             <label for="wctDurationValue" class="form-label">Check-in Window Duration</label>
                             <div class="input-group">
                                <input type="number" class="form-control" id="wctDurationValue" value="1" min="1">
                                <select class="form-select" id="wctDurationUnit">
                                    <option value="hours" selected>Hours</option>
                                    <option value="minutes">Minutes</option>
                                </select>
                             </div>
                             <div class="form-text">How long you have to check-in after the prompt time.</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mt-4 text-center">
                 <button type="submit" class="btn btn-primary btn-lg">Save and Activate Schedule</button>
            </div>
        </form>
    </main>

    {* Include footer *}
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/main.js"></script>
    <script src="js/utils.js"></script>
    {* We will create this JS file in the next step *}
    {* <script src="js/cron-message.js"></script> *}
</body>
</html>